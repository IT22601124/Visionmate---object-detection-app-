{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _reactNative = require(\"react-native\");\nvar tf = _interopRequireWildcard(require(\"@tensorflow/tfjs\"));\nvar _tfjsReactNative = require(\"@tensorflow/tfjs-react-native\");\nvar cocoSsd = _interopRequireWildcard(require(\"@tensorflow-models/coco-ssd\"));\nvar _expoCamera = require(\"expo-camera\");\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _this = this,\n  _jsxFileName = \"F:\\\\node\\\\vision\\\\src\\\\pages\\\\DetectObject.js\";\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nvar TensorCamera = (0, _tfjsReactNative.cameraWithTensors)(_expoCamera.Camera);\nvar DetectObject = function DetectObject() {\n  var _Camera$Constants;\n  var _useState = (0, _react.useState)(null),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    hasPermission = _useState2[0],\n    setHasPermission = _useState2[1];\n  var _useState3 = (0, _react.useState)(null),\n    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n    model = _useState4[0],\n    setModel = _useState4[1];\n  (0, _react.useEffect)(function () {\n    (0, _asyncToGenerator2.default)(function* () {\n      var _yield$Camera$request = yield _expoCamera.Camera.requestCameraPermissionsAsync(),\n        status = _yield$Camera$request.status;\n      setHasPermission(status === 'granted');\n      yield tf.ready();\n      var loadedModel = yield cocoSsd.load();\n      setModel(loadedModel);\n    })();\n    console.log(_expoCamera.Camera);\n  }, []);\n  var handleCameraStream = function handleCameraStream(images, updatePreview, gl) {\n    var _loop = function () {\n      var _ref2 = (0, _asyncToGenerator2.default)(function* () {\n        var nextImageTensor = images.next().value;\n        if (model && nextImageTensor) {\n          var predictions = yield model.detect(nextImageTensor);\n          console.log(predictions);\n        }\n        requestAnimationFrame(_loop);\n      });\n      return function loop() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    _loop();\n  };\n  if (hasPermission === null) {\n    return (0, _jsxRuntime.jsx)(_reactNative.Text, {\n      children: \"Requesting Camera Permission...\"\n    });\n  }\n  if (hasPermission === false) {\n    return (0, _jsxRuntime.jsx)(_reactNative.Text, {\n      children: \"No access to camera\"\n    });\n  }\n  return (0, _jsxRuntime.jsx)(_reactNative.View, {\n    style: styles.container,\n    children: (0, _jsxRuntime.jsx)(TensorCamera, {\n      style: styles.camera,\n      type: ((_Camera$Constants = _expoCamera.Camera.Constants) == null || (_Camera$Constants = _Camera$Constants.Type) == null ? void 0 : _Camera$Constants.back) || _expoCamera.Camera.Type.back,\n      onReady: handleCameraStream,\n      autorender: true\n    })\n  });\n};\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  camera: {\n    flex: 1\n  }\n});\nvar _default = exports.default = DetectObject;","map":{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","tf","_tfjsReactNative","cocoSsd","_expoCamera","_jsxRuntime","_this","_jsxFileName","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","TensorCamera","cameraWithTensors","Camera","DetectObject","_Camera$Constants","_useState","useState","_useState2","_slicedToArray2","hasPermission","setHasPermission","_useState3","_useState4","model","setModel","useEffect","_asyncToGenerator2","_yield$Camera$request","requestCameraPermissionsAsync","status","ready","loadedModel","load","console","log","handleCameraStream","images","updatePreview","gl","loop","_ref2","nextImageTensor","next","value","predictions","detect","requestAnimationFrame","apply","arguments","jsx","Text","children","View","style","styles","container","camera","type","Constants","Type","back","onReady","autorender","StyleSheet","create","flex","_default","exports"],"sources":["F:/node/vision/src/pages/DetectObject.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Text, View, StyleSheet } from 'react-native';\r\nimport * as tf from '@tensorflow/tfjs';\r\nimport { cameraWithTensors } from '@tensorflow/tfjs-react-native';\r\nimport * as cocoSsd from '@tensorflow-models/coco-ssd';\r\nimport { Camera } from 'expo-camera';\r\n\r\n// Wrap Camera with Tensor support\r\nconst TensorCamera = cameraWithTensors(Camera);\r\n\r\nconst DetectObject = () => {\r\n    const [hasPermission, setHasPermission] = useState(null);\r\n    const [model, setModel] = useState(null);\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            const { status } = await Camera.requestCameraPermissionsAsync();\r\n            setHasPermission(status === 'granted');\r\n            await tf.ready();\r\n            const loadedModel = await cocoSsd.load();\r\n            setModel(loadedModel);\r\n        })();\r\n\r\n        // Log to check the Camera object and available constants\r\n        console.log(Camera); \r\n    }, []);\r\n\r\n    const handleCameraStream = (images, updatePreview, gl) => {\r\n        const loop = async () => {\r\n            const nextImageTensor = images.next().value;\r\n            if (model && nextImageTensor) {\r\n                const predictions = await model.detect(nextImageTensor);\r\n                console.log(predictions);\r\n            }\r\n            requestAnimationFrame(loop);\r\n        };\r\n        loop();\r\n    };\r\n\r\n    if (hasPermission === null) {\r\n        return <Text>Requesting Camera Permission...</Text>;\r\n    }\r\n    if (hasPermission === false) {\r\n        return <Text>No access to camera</Text>;\r\n    }\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <TensorCamera\r\n                style={styles.camera}\r\n                // Use Camera.Constants.Type.back if available, otherwise Camera.Type.back\r\n                type={Camera.Constants?.Type?.back || Camera.Type.back}\r\n                onReady={handleCameraStream}\r\n                autorender={true}\r\n            />\r\n        </View>\r\n    );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n    },\r\n    camera: {\r\n        flex: 1,\r\n    },\r\n});\r\n\r\nexport default DetectObject;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}